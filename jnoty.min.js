(function($){$.jnoty=function(m,o){if($('#jnoty').length===0)
$('<div id="jnoty"></div>').addClass((o&&o.position)?o.position:$.jnoty.defaults.position).appendTo((o&&o.appendTo)?o.appendTo:$.jnoty.defaults.appendTo);$('#jnoty').jnoty(m,o)};$.fn.jnoty=function(m,o){if(o===undefined&&$.isPlainObject(m)){o=m;m=o.message}
if($.isFunction(this.each)){var args=arguments;return this.each(function(){if($(this).data('jnoty.instance')===undefined){$(this).data('jnoty.instance',$.extend(new $.fn.jnoty(),{notifications:[],element:null,interval:null}));$(this).data('jnoty.instance').startup(this)}
if($.isFunction($(this).data('jnoty.instance')[m])){$(this).data('jnoty.instance')[m].apply($(this).data('jnoty.instance'),$.makeArray(args).slice(1))}else{$(this).data('jnoty.instance').create(m,o)}})}};$.extend($.fn.jnoty.prototype,{defaults:{pool:0,icon:'',header:'',sticky:!1,position:'top-right',appendTo:'body',glue:'after',theme:'jnoty-info',themeState:'highlight',corners:'10px',check:250,life:3000,closeDuration:'normal',openDuration:'normal',easing:'linear',closer:!1,closeTemplate:'&times;',closerTemplate:'<div>[ close all ]</div>',log:function(){},beforeOpen:function(){},afterOpen:function(){},open:function(){},beforeClose:function(){},close:function(){},click:function(){},animateOpen:{opacity:'show'},animateClose:{opacity:'hide'}},notifications:[],element:null,interval:null,create:function(message,options){var o=$.extend({},this.defaults,options);if(typeof o.speed!=='undefined'){o.openDuration=o.speed;o.closeDuration=o.speed}
this.notifications.push({message:message,options:o});o.log.apply(this.element,[this.element,message,o])},render:function(n){var self=this;var message=n.message;var o=n.options;o.themeState=(o.themeState==='')?'':'ui-state-'+o.themeState;var notification=$('<div/>').addClass('jnoty-container '+o.themeState+'').append($('<button/>').addClass('jnoty-close').html(o.closeTemplate)).append($('<div/>').addClass('jnoty-content').append($('<div/>').addClass('jnoty-header').append($('<span/>').addClass('jnoty-icon').append($('<i/>').addClass(o.icon))).append($('<span/>').addClass('jnoty-title').html(o.header))).append($('<div/>').addClass('jnoty-message').html(message))).data("jnoty",o).addClass(o.theme).children('.jnoty-close').bind("click.jnoty",function(){$(this).parent().trigger('jnoty.beforeClose');return!1}).parent();$(notification).bind("mouseover.jnoty",function(){$('.jnoty-container',self.element).data("jnoty.pause",!0)}).bind("mouseout.jnoty",function(){$('.jnoty-container',self.element).data("jnoty.pause",!1)}).bind('jnoty.beforeOpen',function(){if(o.beforeOpen.apply(notification,[notification,message,o,self.element])!==!1){$(this).trigger('jnoty.open')}}).bind('jnoty.open',function(){if(o.open.apply(notification,[notification,message,o,self.element])!==!1){if(o.glue=='after'){$('.jnoty-container:last',self.element).after(notification)}else{$('.jnoty-container:first',self.element).before(notification)}
$(this).animate(o.animateOpen,o.openDuration,o.easing,function(){if($.support.opacity===!1)
this.style.removeAttribute('filter');if($(this).data("jnoty")!==null&&typeof $(this).data("noty")!=='undefined')
$(this).data("jnoty").created=new Date();$(this).trigger('jnoty.afterOpen')})}}).bind('jnoty.afterOpen',function(){o.afterOpen.apply(notification,[notification,message,o,self.element])}).bind('click',function(){o.click.apply(notification,[notification,message,o,self.element])}).bind('jnoty.beforeClose',function(){if(o.beforeClose.apply(notification,[notification,message,o,self.element])!==!1)
$(this).trigger('jnoty.close')}).bind('jnoty.close',function(){$(this).data('jnoty.pause',!0);$(this).animate(o.animateClose,o.closeDuration,o.easing,function(){if($.isFunction(o.close)){if(o.close.apply(notification,[notification,message,o,self.element])!==!1)
$(this).remove()}else{$(this).remove()}})}).trigger('jnoty.beforeOpen');if(o.corners!==''&&$.fn.corner!==undefined)$(notification).corner(o.corners);if($('.jnoty-container:parent',self.element).length>1&&$('.jnoty-closer',self.element).length===0&&this.defaults.closer!==!1){$(this.defaults.closerTemplate).addClass('jnoty-closer '+this.defaults.themeState+' ui-corner-all').addClass(this.defaults.theme).appendTo(self.element).animate(this.defaults.animateOpen,this.defaults.speed,this.defaults.easing).bind("click.jnoty",function(){$(this).siblings().trigger("jnoty.beforeClose");if($.isFunction(self.defaults.closer)){self.defaults.closer.apply($(this).parent()[0],[$(this).parent()[0]])}})}},update:function(){$(this.element).find('.jnoty-container:parent').each(function(){if($(this).data("jnoty")!==undefined&&$(this).data("jnoty").created!==undefined&&($(this).data("jnoty").created.getTime()+parseInt($(this).data("jnoty").life,10))<(new Date()).getTime()&&$(this).data("jnoty").sticky!==!0&&($(this).data("jnoty.pause")===undefined||$(this).data("jnoty.pause")!==!0)){$(this).trigger('jnoty.beforeClose')}});if(this.notifications.length>0&&(this.defaults.pool===0||$(this.element).find('.jnoty-container:parent').length<this.defaults.pool))
this.render(this.notifications.shift());if($(this.element).find('.jnoty-container:parent').length<2){$(this.element).find('.jnoty-closer').animate(this.defaults.animateClose,this.defaults.speed,this.defaults.easing,function(){$(this).remove()})}},startup:function(e){this.element=$(e).addClass('jnoty').append('<div class="jnoty-container"></div>');this.interval=setInterval(function(){var instance=$(e).data('jnoty.instance');if(undefined!==instance){instance.update()}},parseInt(this.defaults.check,10))},shutdown:function(){$(this.element).removeClass('jnoty').find('.jnoty-container').trigger('jnoty.close').parent().empty();clearInterval(this.interval)},close:function(){$(this.element).find('.jnoty-container').each(function(){$(this).trigger('jnoty.beforeClose')})}});$.jnoty.defaults=$.fn.jnoty.prototype.defaults})(jQuery)